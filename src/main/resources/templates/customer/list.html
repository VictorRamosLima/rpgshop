<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: page('Clientes', ~{::main-content})}">
<div th:fragment="main-content">

    <div class="breadcrumb">
        <a href="/">Início</a> <span>/</span> <span>Clientes</span>
    </div>

    <div class="page-header">
        <h1>&#128101; Clientes</h1>
        <a href="/customers/new" class="btn btn-primary">Novo Cliente</a>
    </div>

    <div class="filter-bar">
        <form method="get" action="/customers" class="form-inline">
            <div class="form-group">
                <label>Nome</label>
                <input type="text" name="name" th:value="${param.name}" placeholder="Buscar por nome..."/>
            </div>
            <div class="form-group">
                <label>CPF</label>
                <input type="text" name="cpf" th:value="${param.cpf}" placeholder="000.000.000-00"/>
            </div>
            <div class="form-group">
                <label>E-mail</label>
                <input type="text" name="email" th:value="${param.email}" placeholder="email@exemplo.com"/>
            </div>
            <div class="form-group">
                <label>Gênero</label>
                <select name="gender">
                    <option value="">Todos</option>
                    <option th:each="g : ${genders}" th:value="${g}" th:text="${g}" th:selected="${param.gender != null && param.gender.toString() == g.toString()}"></option>
                </select>
            </div>
            <div class="form-group">
                <label>Status</label>
                <select name="isActive">
                    <option value="">Todos</option>
                    <option value="true" th:selected="${param.isActive != null && param.isActive.toString() == 'true'}">Ativo</option>
                    <option value="false" th:selected="${param.isActive != null && param.isActive.toString() == 'false'}">Inativo</option>
                </select>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Filtrar</button>
            </div>
        </form>
    </div>

    <div th:if="${customers != null && !customers.content.isEmpty()}">
        <table>
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>CPF</th>
                    <th>E-mail</th>
                    <th>Gênero</th>
                    <th>Status</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="customer : ${customers.content}">
                    <td th:text="${customer.name()}"></td>
                    <td th:text="${customer.cpf()}"></td>
                    <td th:text="${customer.email()}"></td>
                    <td th:text="${customer.gender()}"></td>
                    <td>
                        <span th:if="${customer.isActive()}" class="badge badge-active">Ativo</span>
                        <span th:unless="${customer.isActive()}" class="badge badge-inactive">Inativo</span>
                    </td>
                    <td class="actions-cell">
                        <a th:href="@{/customers/{id}(id=${customer.id()})}" class="btn btn-sm btn-outline">Detalhes</a>
                        <a th:href="@{/cart/{id}(id=${customer.id()})}" class="btn btn-sm btn-accent">Carrinho</a>
                        <a th:href="@{/orders/customer/{id}(id=${customer.id()})}" class="btn btn-sm btn-primary">Pedidos</a>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="pagination" th:if="${customers.totalPages > 1}">
            <span th:each="i : ${#numbers.sequence(0, customers.totalPages - 1)}">
                <a th:href="@{/customers(page=${i}, name=${param.name}, cpf=${param.cpf}, email=${param.email}, gender=${param.gender}, isActive=${param.isActive})}"
                   th:text="${i + 1}"
                   th:if="${i != customers.number}"></a>
                <strong th:text="${i + 1}" th:if="${i == customers.number}"></strong>
            </span>
        </div>
    </div>

    <div th:if="${customers == null || customers.content.isEmpty()}" class="empty-state">
        <div class="empty-state-icon">&#128101;</div>
        <div class="empty-state-text">Nenhum cliente encontrado</div>
        <p>Tente ajustar os filtros ou <a href="/customers/new">cadastre um novo cliente</a>.</p>
    </div>

</div>
</html>
